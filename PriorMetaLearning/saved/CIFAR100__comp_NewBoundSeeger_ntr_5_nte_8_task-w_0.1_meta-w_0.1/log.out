Log file created at  2019-04-22 16:56:48
Run script: main_Meta_Bayes.py
Parameters:
Namespace(K_Shot_MetaTest=100, K_Shot_MetaTrain=100, N_Way=5, batch_size=16, chars_split_type='random', complexity_type='NewBoundSeeger', data_path='/data5/tlgao/meta/meta-learning-adjusting-priors/ML_data_sets', data_source='CIFAR100', data_transform='None', limit_train_samples_in_test_tasks=2000, load_model_path='', loss_type='CrossEntropy', lr=0.001, meta_batch_size=16, meta_complex_w=0.1, mode='MetaTrain', model_name='CIFARNet', n_inner_steps=50, n_meta_test_epochs=10, n_meta_train_chars=1200, n_meta_train_classes=500, n_meta_train_epochs=10, n_pixels_shuffles=200, n_test_tasks=8, n_train_tasks=5, result_dir='saved/CIFAR100__comp_NewBoundSeeger_ntr_5_nte_8_task-w_0.1_meta-w_0.1', run_name='CIFAR100__comp_NewBoundSeeger_ntr_5_nte_8_task-w_0.1_meta-w_0.1', seed=1, task_complex_w=0.1, test_batch_size=128)
--------------------------------------------------
--- Generating 5 training-tasks
Stochastic-CIFARNet
---- Meta-Training set: 5 tasks
Run finished at:  2019-04-22 16:59:39
MaxPosterior Average Test Error: 31.1%	 Runtime: 154.15797306410968 [sec]
Trained prior saved in saved/CIFAR100__comp_NewBoundSeeger_ntr_5_nte_8_task-w_0.1_meta-w_0.1/model.pt
---- Generating 8 test-tasks with at most 2000 training samples
Meta-Testing with transferred prior....
(0.0%)	Epoch: 0 	 Batch: 0 	 Objective: 1.65 	  Acc: 0.125	 Empiric Loss: 1.626	 Intra-Comp. 0.2374
(10.0%)	Epoch: 1 	 Batch: 0 	 Objective: 1.423 	  Acc: 0.375	 Empiric Loss: 1.401	 Intra-Comp. 0.2224
(20.0%)	Epoch: 2 	 Batch: 0 	 Objective: 1.436 	  Acc: 0.5	 Empiric Loss: 1.414	 Intra-Comp. 0.2232
(30.0%)	Epoch: 3 	 Batch: 0 	 Objective: 0.7796 	  Acc: 0.75	 Empiric Loss: 0.7625	 Intra-Comp. 0.1712
(40.0%)	Epoch: 4 	 Batch: 0 	 Objective: 0.6671 	  Acc: 0.875	 Empiric Loss: 0.6511	 Intra-Comp. 0.1602
(50.0%)	Epoch: 5 	 Batch: 0 	 Objective: 0.7664 	  Acc: 0.688	 Empiric Loss: 0.7494	 Intra-Comp. 0.1699
(60.0%)	Epoch: 6 	 Batch: 0 	 Objective: 0.549 	  Acc: 0.75	 Empiric Loss: 0.5343	 Intra-Comp. 0.1477
(70.0%)	Epoch: 7 	 Batch: 0 	 Objective: 0.5628 	  Acc: 0.875	 Empiric Loss: 0.5479	 Intra-Comp. 0.1493
(80.0%)	Epoch: 8 	 Batch: 0 	 Objective: 0.6748 	  Acc: 0.812	 Empiric Loss: 0.6587	 Intra-Comp. 0.161
(90.0%)	Epoch: 9 	 Batch: 0 	 Objective: 0.6949 	  Acc: 0.812	 Empiric Loss: 0.6786	 Intra-Comp. 0.163
MaxPosterior Average Test Error: 30.4%	 Runtime: 32.46370798069984 [sec]
0 task : Error 0.3044, Complexity 0.15034416317939758, loss 0.8411456942558289
(0.0%)	Epoch: 0 	 Batch: 0 	 Objective: 1.614 	  Acc: 0.312	 Empiric Loss: 1.591	 Intra-Comp. 0.2351
(10.0%)	Epoch: 1 	 Batch: 0 	 Objective: 1.659 	  Acc: 0.25	 Empiric Loss: 1.635	 Intra-Comp. 0.238
(20.0%)	Epoch: 2 	 Batch: 0 	 Objective: 1.089 	  Acc: 0.625	 Empiric Loss: 1.07	 Intra-Comp. 0.1977
(30.0%)	Epoch: 3 	 Batch: 0 	 Objective: 1.014 	  Acc: 0.562	 Empiric Loss: 0.9951	 Intra-Comp. 0.1917
(40.0%)	Epoch: 4 	 Batch: 0 	 Objective: 1.107 	  Acc: 0.688	 Empiric Loss: 1.087	 Intra-Comp. 0.1992
(50.0%)	Epoch: 5 	 Batch: 0 	 Objective: 0.7989 	  Acc: 0.75	 Empiric Loss: 0.7816	 Intra-Comp. 0.173
(60.0%)	Epoch: 6 	 Batch: 0 	 Objective: 1.068 	  Acc: 0.438	 Empiric Loss: 1.049	 Intra-Comp. 0.1961
(70.0%)	Epoch: 7 	 Batch: 0 	 Objective: 0.7333 	  Acc: 0.688	 Empiric Loss: 0.7166	 Intra-Comp. 0.1668
(80.0%)	Epoch: 8 	 Batch: 0 	 Objective: 0.4497 	  Acc: 0.812	 Empiric Loss: 0.4361	 Intra-Comp. 0.1361
(90.0%)	Epoch: 9 	 Batch: 0 	 Objective: 0.4584 	  Acc: 0.812	 Empiric Loss: 0.4447	 Intra-Comp. 0.1372
MaxPosterior Average Test Error: 39.8%	 Runtime: 33.1983613492921 [sec]
1 task : Error 0.3984, Complexity 0.16760855913162231, loss 1.0612233877182007
(0.0%)	Epoch: 0 	 Batch: 0 	 Objective: 1.626 	  Acc: 0.312	 Empiric Loss: 1.603	 Intra-Comp. 0.2359
(10.0%)	Epoch: 1 	 Batch: 0 	 Objective: 0.876 	  Acc: 0.688	 Empiric Loss: 0.858	 Intra-Comp. 0.1799
(20.0%)	Epoch: 2 	 Batch: 0 	 Objective: 0.7797 	  Acc: 0.75	 Empiric Loss: 0.7626	 Intra-Comp. 0.1712
(30.0%)	Epoch: 3 	 Batch: 0 	 Objective: 0.6607 	  Acc: 0.688	 Empiric Loss: 0.6448	 Intra-Comp. 0.1596
(40.0%)	Epoch: 4 	 Batch: 0 	 Objective: 0.7785 	  Acc: 0.75	 Empiric Loss: 0.7614	 Intra-Comp. 0.1711
(50.0%)	Epoch: 5 	 Batch: 0 	 Objective: 0.6814 	  Acc: 0.75	 Empiric Loss: 0.6652	 Intra-Comp. 0.1617
(60.0%)	Epoch: 6 	 Batch: 0 	 Objective: 0.3937 	  Acc: 0.875	 Empiric Loss: 0.3808	 Intra-Comp. 0.129
(70.0%)	Epoch: 7 	 Batch: 0 	 Objective: 0.5036 	  Acc: 0.75	 Empiric Loss: 0.4894	 Intra-Comp. 0.1426
(80.0%)	Epoch: 8 	 Batch: 0 	 Objective: 0.4037 	  Acc: 0.812	 Empiric Loss: 0.3906	 Intra-Comp. 0.1303
(90.0%)	Epoch: 9 	 Batch: 0 	 Objective: 0.5545 	  Acc: 0.812	 Empiric Loss: 0.5397	 Intra-Comp. 0.1483
MaxPosterior Average Test Error: 26.9%	 Runtime: 32.59264575690031 [sec]
2 task : Error 0.26880000000000004, Complexity 0.13604220747947693, loss 0.7714505195617676
(0.0%)	Epoch: 0 	 Batch: 0 	 Objective: 1.625 	  Acc: 0.25	 Empiric Loss: 1.601	 Intra-Comp. 0.2358
(10.0%)	Epoch: 1 	 Batch: 0 	 Objective: 1.486 	  Acc: 0.188	 Empiric Loss: 1.463	 Intra-Comp. 0.2266
(20.0%)	Epoch: 2 	 Batch: 0 	 Objective: 1.28 	  Acc: 0.562	 Empiric Loss: 1.258	 Intra-Comp. 0.2122
(30.0%)	Epoch: 3 	 Batch: 0 	 Objective: 0.9671 	  Acc: 0.688	 Empiric Loss: 0.9483	 Intra-Comp. 0.1878
(40.0%)	Epoch: 4 	 Batch: 0 	 Objective: 0.9188 	  Acc: 0.625	 Empiric Loss: 0.9004	 Intra-Comp. 0.1837
(50.0%)	Epoch: 5 	 Batch: 0 	 Objective: 0.69 	  Acc: 0.75	 Empiric Loss: 0.6737	 Intra-Comp. 0.1625
(60.0%)	Epoch: 6 	 Batch: 0 	 Objective: 0.7056 	  Acc: 0.625	 Empiric Loss: 0.6892	 Intra-Comp. 0.1641
(70.0%)	Epoch: 7 	 Batch: 0 	 Objective: 0.8897 	  Acc: 0.688	 Empiric Loss: 0.8716	 Intra-Comp. 0.1811
(80.0%)	Epoch: 8 	 Batch: 0 	 Objective: 0.6625 	  Acc: 0.75	 Empiric Loss: 0.6465	 Intra-Comp. 0.1598
(90.0%)	Epoch: 9 	 Batch: 0 	 Objective: 0.651 	  Acc: 0.688	 Empiric Loss: 0.6352	 Intra-Comp. 0.1586
MaxPosterior Average Test Error: 39.9%	 Runtime: 33.365833978168666 [sec]
3 task : Error 0.39880000000000004, Complexity 0.15903906524181366, loss 0.9928780794143677
(0.0%)	Epoch: 0 	 Batch: 0 	 Objective: 1.618 	  Acc: 0.25	 Empiric Loss: 1.595	 Intra-Comp. 0.2354
(10.0%)	Epoch: 1 	 Batch: 0 	 Objective: 1.347 	  Acc: 0.5	 Empiric Loss: 1.326	 Intra-Comp. 0.217
(20.0%)	Epoch: 2 	 Batch: 0 	 Objective: 1.118 	  Acc: 0.688	 Empiric Loss: 1.098	 Intra-Comp. 0.1999
(30.0%)	Epoch: 3 	 Batch: 0 	 Objective: 0.8538 	  Acc: 0.688	 Empiric Loss: 0.836	 Intra-Comp. 0.178
(40.0%)	Epoch: 4 	 Batch: 0 	 Objective: 0.8246 	  Acc: 0.562	 Empiric Loss: 0.8071	 Intra-Comp. 0.1753
(50.0%)	Epoch: 5 	 Batch: 0 	 Objective: 0.726 	  Acc: 0.688	 Empiric Loss: 0.7094	 Intra-Comp. 0.1661
(60.0%)	Epoch: 6 	 Batch: 0 	 Objective: 0.786 	  Acc: 0.688	 Empiric Loss: 0.7688	 Intra-Comp. 0.1718
(70.0%)	Epoch: 7 	 Batch: 0 	 Objective: 0.5446 	  Acc: 0.75	 Empiric Loss: 0.5299	 Intra-Comp. 0.1472
(80.0%)	Epoch: 8 	 Batch: 0 	 Objective: 0.8197 	  Acc: 0.688	 Empiric Loss: 0.8022	 Intra-Comp. 0.1749
(90.0%)	Epoch: 9 	 Batch: 0 	 Objective: 0.4984 	  Acc: 0.75	 Empiric Loss: 0.4842	 Intra-Comp. 0.142
MaxPosterior Average Test Error: 30.1%	 Runtime: 32.966875174082816 [sec]
4 task : Error 0.3012, Complexity 0.17524223029613495, loss 0.8338894844055176
(0.0%)	Epoch: 0 	 Batch: 0 	 Objective: 1.616 	  Acc: 0.25	 Empiric Loss: 1.593	 Intra-Comp. 0.2353
(10.0%)	Epoch: 1 	 Batch: 0 	 Objective: 1.172 	  Acc: 0.438	 Empiric Loss: 1.152	 Intra-Comp. 0.2041
(20.0%)	Epoch: 2 	 Batch: 0 	 Objective: 1.418 	  Acc: 0.562	 Empiric Loss: 1.396	 Intra-Comp. 0.222
(30.0%)	Epoch: 3 	 Batch: 0 	 Objective: 1.346 	  Acc: 0.5	 Empiric Loss: 1.324	 Intra-Comp. 0.2169
(40.0%)	Epoch: 4 	 Batch: 0 	 Objective: 1.048 	  Acc: 0.5	 Empiric Loss: 1.028	 Intra-Comp. 0.1944
(50.0%)	Epoch: 5 	 Batch: 0 	 Objective: 0.7297 	  Acc: 0.938	 Empiric Loss: 0.7131	 Intra-Comp. 0.1664
(60.0%)	Epoch: 6 	 Batch: 0 	 Objective: 0.933 	  Acc: 0.625	 Empiric Loss: 0.9145	 Intra-Comp. 0.1849
(70.0%)	Epoch: 7 	 Batch: 0 	 Objective: 0.9292 	  Acc: 0.625	 Empiric Loss: 0.9108	 Intra-Comp. 0.1846
(80.0%)	Epoch: 8 	 Batch: 0 	 Objective: 0.7039 	  Acc: 0.75	 Empiric Loss: 0.6875	 Intra-Comp. 0.1639
(90.0%)	Epoch: 9 	 Batch: 0 	 Objective: 0.9165 	  Acc: 0.688	 Empiric Loss: 0.8982	 Intra-Comp. 0.1835
MaxPosterior Average Test Error: 36.0%	 Runtime: 33.470283535309136 [sec]
5 task : Error 0.35960000000000003, Complexity 0.15513862669467926, loss 1.001028299331665
(0.0%)	Epoch: 0 	 Batch: 0 	 Objective: 1.638 	  Acc: 0.125	 Empiric Loss: 1.615	 Intra-Comp. 0.2367
(10.0%)	Epoch: 1 	 Batch: 0 	 Objective: 1.256 	  Acc: 0.375	 Empiric Loss: 1.235	 Intra-Comp. 0.2104
(20.0%)	Epoch: 2 	 Batch: 0 	 Objective: 1.05 	  Acc: 0.75	 Empiric Loss: 1.031	 Intra-Comp. 0.1946
(30.0%)	Epoch: 3 	 Batch: 0 	 Objective: 0.9027 	  Acc: 0.625	 Empiric Loss: 0.8845	 Intra-Comp. 0.1823
(40.0%)	Epoch: 4 	 Batch: 0 	 Objective: 1.056 	  Acc: 0.562	 Empiric Loss: 1.037	 Intra-Comp. 0.1951
(50.0%)	Epoch: 5 	 Batch: 0 	 Objective: 0.4575 	  Acc: 0.75	 Empiric Loss: 0.4438	 Intra-Comp. 0.137
(60.0%)	Epoch: 6 	 Batch: 0 	 Objective: 0.6097 	  Acc: 0.812	 Empiric Loss: 0.5942	 Intra-Comp. 0.1543
(70.0%)	Epoch: 7 	 Batch: 0 	 Objective: 0.6225 	  Acc: 0.812	 Empiric Loss: 0.6069	 Intra-Comp. 0.1557
(80.0%)	Epoch: 8 	 Batch: 0 	 Objective: 0.3957 	  Acc: 0.875	 Empiric Loss: 0.3828	 Intra-Comp. 0.1292
(90.0%)	Epoch: 9 	 Batch: 0 	 Objective: 0.7048 	  Acc: 0.75	 Empiric Loss: 0.6884	 Intra-Comp. 0.164
MaxPosterior Average Test Error: 30.9%	 Runtime: 32.18333405908197 [sec]
6 task : Error 0.30920000000000003, Complexity 0.1463950127363205, loss 0.9211716055870056
(0.0%)	Epoch: 0 	 Batch: 0 	 Objective: 1.593 	  Acc: 0.312	 Empiric Loss: 1.569	 Intra-Comp. 0.2337
(10.0%)	Epoch: 1 	 Batch: 0 	 Objective: 1.35 	  Acc: 0.625	 Empiric Loss: 1.328	 Intra-Comp. 0.2172
(20.0%)	Epoch: 2 	 Batch: 0 	 Objective: 1.535 	  Acc: 0.25	 Empiric Loss: 1.512	 Intra-Comp. 0.2299
(30.0%)	Epoch: 3 	 Batch: 0 	 Objective: 1.067 	  Acc: 0.562	 Empiric Loss: 1.048	 Intra-Comp. 0.196
(40.0%)	Epoch: 4 	 Batch: 0 	 Objective: 0.6003 	  Acc: 0.688	 Empiric Loss: 0.5849	 Intra-Comp. 0.1533
(50.0%)	Epoch: 5 	 Batch: 0 	 Objective: 1.208 	  Acc: 0.5	 Empiric Loss: 1.187	 Intra-Comp. 0.2069
(60.0%)	Epoch: 6 	 Batch: 0 	 Objective: 0.9779 	  Acc: 0.562	 Empiric Loss: 0.9591	 Intra-Comp. 0.1887
(70.0%)	Epoch: 7 	 Batch: 0 	 Objective: 0.7787 	  Acc: 0.75	 Empiric Loss: 0.7616	 Intra-Comp. 0.1711
(80.0%)	Epoch: 8 	 Batch: 0 	 Objective: 0.4398 	  Acc: 0.875	 Empiric Loss: 0.4263	 Intra-Comp. 0.1349
(90.0%)	Epoch: 9 	 Batch: 0 	 Objective: 0.6164 	  Acc: 0.75	 Empiric Loss: 0.6009	 Intra-Comp. 0.155
MaxPosterior Average Test Error: 34.2%	 Runtime: 33.308232511393726 [sec]
7 task : Error 0.34199999999999997, Complexity 0.16519291698932648, loss 0.9403219223022461
Total runtime: 00 hours, 07 minutes and 16 seconds
----- Final Results: 
----- Meta-Testing - Avg test err: 33.5%, STD: 4.45%, Avg test loss : 0.92, std : 0.0922, Avg complexity : 0.157, std : 0.0118
